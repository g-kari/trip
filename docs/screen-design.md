# 画面設計書

## ページ構成

| # | ページ | パス | 認証 | 概要 |
|---|--------|------|------|------|
| 1 | ランディングページ | `/` | 不要 | サービス紹介 + CTA |
| 2 | ログイン | `/login` | 不要 | Google / LINE ソーシャルログイン |
| 3 | 旅行一覧 | `/trips` | 必須 | マイ旅程の一覧・ダッシュボード |
| 4 | 新規作成 | `/trips/new` | 必須 | タイトル・日程・テーマを入力して作成 |
| 5 | 旅程ページ（閲覧） | `/trips/:id` | 必須 | 旅程の閲覧ビュー（＝商品本体） |
| 6 | 旅程ページ（編集） | `/trips/:id/edit` | 必須（オーナー） | 旅程の編集・AI生成・共有設定 |
| 7 | 共有ページ | `/s/:token` | 不要 | 招待リンク経由の閲覧専用ビュー |

---

## 共通レイアウトルール

- **最大幅 480px、中央寄せ** — 全ページ共通。モバイルファースト
- **ヘッダー**: 薄い下線ボーダー。左にロゴ or 戻るボタン、右にアクション
- **フッター**: 最小限。旅程ページのみアトリビューション表示
- **保存**: 編集ページは**自動保存**（入力のたびに debounce して API 送信）。明示的な「保存」ボタンは置かない

---

## 1. 旅程ページ `/trips/:id`（＝商品本体）

サービスの核となるページ。共有ページ `/s/:token` も同じレイアウトを使用。

### しずかテーマ

```
┌─────────────────────────┐
│  旅程            [編集]  │  ← ヘッダー（オーナーのみ編集・共有ボタン）
├─────────────────────────┤
│                         │
│    京都・奈良 3日間      │  ← タイトル（1.5rem, 中央寄せ）
│    2026.3.15 — 3.17     │  ← 日程（muted, 小さめ）
│                         │
├─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┤  ← 細い区切り線
│                         │
│  Day 1 — 3月15日(日)    │  ← 日付ヘッダー
│                         │
│  10:00  京都駅 到着      │  ← タイムライングリッド
│         ───────────     │    (時刻56px | コンテンツ)
│  11:30  伏見稲荷大社     │
│         稲荷エリア       │  ← エリア（muted）
│         千本鳥居を散策    │  ← メモ（faint, 小さめ）
│         ───────────     │
│  13:00  祢ざめ家         │
│         ¥1,200          │  ← コスト（muted）
│                         │
│  Day 2 — 3月16日(月)    │
│  ...                    │
│                         │
├─────────────────────────┤
│  旅程で作成              │  ← フッター（アトリビューション）
└─────────────────────────┘
```

### 写真映えテーマ（差分のみ）

```
┌─────────────────────────┐
│                         │
│  ┌───────────────────┐  │
│  │                   │  │
│  │  カバー画像(16:9) │  │  ← 幅100%、角丸なし
│  │                   │  │
│  │  京都・奈良 3日間  │  │  ← 画像上にオーバーレイ（白文字+影）
│  └───────────────────┘  │
│    2026.3.15 — 3.17     │
│                         │
│  （以降タイムラインは同じ  │  ← フォントウェイトでメリハリ強め
│   構造、コントラスト強）   │
└─────────────────────────┘
```

### 状態

| 状態 | 表示 |
|------|------|
| ローディング | スケルトン表示（タイトル＋タイムライン3行分のプレースホルダー） |
| エラー（404/権限なし） | 「この旅程は見つかりませんでした」中央表示 |
| 共有ページ | ヘッダーの編集・共有ボタンを非表示。フッターに「旅程で作成」リンク |

---

## 2. 旅程編集 `/trips/:id/edit`

```
┌─────────────────────────┐
│  ← 戻る     [プレビュー] │  ← ヘッダー（戻る=一覧へ）
├─────────────────────────┤
│                         │
│  タイトル [京都・奈良... ]│  ← インライン編集フィールド
│  日程  [3/15] — [3/17]  │
│  テーマ  ◉しずか ○写真映え│  ← ラジオ切替
│                         │
│  ┌───────────────────┐  │
│  │ カバー画像         │  │  ← 写真映えテーマ時のみ表示
│  │ [画像選択] or      │  │
│  │  ドラッグ&ドロップ  │  │
│  └───────────────────┘  │
│                         │
├─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┤
│                         │
│  [テキストから自動生成]   │  ← AI生成ボタン（モーダルを開く）
│                         │
├─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┤
│                         │
│  Day 1 — 3月15日        │
│  ┌─────────────────┐    │
│  │ 10:00  京都駅到着 │    │  ← 各アイテムはカード型
│  │ エリア: 京都駅    │    │    タップで展開/編集
│  │ メモ: ...        │    │
│  │    [削除]        │    │
│  └─────────────────┘    │
│  ┌─────────────────┐    │
│  │ 11:30  伏見稲荷   │    │
│  │ ...              │    │
│  └─────────────────┘    │
│  [+ アイテムを追加]      │  ← Day内の末尾に追加ボタン
│                         │
│  Day 2 — 3月16日        │
│  ...                    │
│  [+ アイテムを追加]      │
│                         │
│  [+ 日を追加]            │  ← 全Dayの末尾
│                         │
├─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┤
│  共有                    │
│  リンク: https://...     │  ← コピーボタン付き
│  [リンクを無効化] [再発行]│
│                         │
└─────────────────────────┘
```

### AI 生成モーダル

```
┌─────────────────────────┐
│  テキストから旅程を生成   │
│                         │
│  ┌───────────────────┐  │
│  │ ここに旅程テキスト  │  │  ← textarea（10行程度）
│  │ を貼り付け...      │  │
│  │                   │  │
│  └───────────────────┘  │
│                         │
│  [キャンセル]   [生成]   │
│                         │
│  ※ 既存の旅程は上書き    │  ← 注意書き（faint）
│    されます              │
└─────────────────────────┘
```

### 編集の操作仕様

- **自動保存**: 各フィールドの変更を debounce（500ms）して自動で API に送信
- **アイテム並び替え**: ドラッグ&ドロップ（将来対応）、MVP では sort 値を手動変更しない
- **アイテム削除**: 確認なしで即削除（Undo で戻せる設計を将来検討）
- **カバー画像**: 写真映えテーマ選択時のみアップロード UI を表示

---

## 3. 旅行一覧 `/trips`

```
┌─────────────────────────┐
│  旅程          [アバター] │  ← ヘッダー（ロゴ + ユーザーメニュー）
├─────────────────────────┤
│                         │
│  マイ旅程                │
│                         │
│  ┌───────────────────┐  │
│  │ 京都・奈良 3日間    │  │  ← トリップカード
│  │ 2026.3.15 — 3.17  │  │    タップで /trips/:id へ
│  │ しずか             │  │  ← テーマバッジ（小さく）
│  └───────────────────┘  │
│  ┌───────────────────┐  │
│  │ 台北 週末旅行      │  │
│  │ 2026.4.5 — 4.7    │  │
│  │ 写真映え           │  │  ← カバー画像のサムネイル（あれば）
│  └───────────────────┘  │
│                         │
│  [+ あたらしい旅程]      │  ← 末尾に配置（btn-outline）
│                         │
└─────────────────────────┘
```

### 空の状態

```
┌─────────────────────────┐
│                         │
│                         │
│    まだ旅程がありません    │  ← faintテキスト、中央
│                         │
│    [あたらしい旅程をつくる] │  ← btn-filled
│                         │
│                         │
└─────────────────────────┘
```

---

## 4. 新規作成 `/trips/new`

```
┌─────────────────────────┐
│  ← 戻る                 │
├─────────────────────────┤
│                         │
│  あたらしい旅程           │
│                         │
│  タイトル                │
│  [                    ] │
│                         │
│  日程                    │
│  [開始日]  —  [終了日]   │
│                         │
│  テーマ                  │
│  ┌──────┐  ┌──────┐    │
│  │しずか │  │写真映え│    │  ← 選択カード（プレビュー画像付き）
│  │      │  │      │    │
│  │ ◉    │  │ ○    │    │
│  └──────┘  └──────┘    │
│                         │
│  [つくる]                │  ← btn-filled, 下部固定
│                         │
└─────────────────────────┘
```

### バリデーション

| フィールド | ルール |
|-----------|--------|
| タイトル | 必須、1〜100文字 |
| 開始日 | 必須 |
| 終了日 | 必須、開始日以降 |
| テーマ | 必須、デフォルト「しずか」 |

---

## 5. ランディングページ `/`（Phase 4 で実装）

```
┌─────────────────────────┐
│  旅程           [ログイン]│
├─────────────────────────┤
│                         │
│  作るだけで綺麗。         │  ← メインコピー
│  旅の思い出を、           │
│  そのまま人に見せられる    │
│  ページに。               │
│                         │
│  [無料ではじめる]         │  ← CTA → /login
│                         │
├─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┤
│                         │
│  特徴 ×3               │
│  ① テーマを選ぶだけ      │  ← しずか/写真映えのプレビュー
│  ② AIで旅程を自動生成    │  ← テキスト→旅程の変換イメージ
│  ③ リンクひとつで共有     │  ← 招待リンクのイメージ
│                         │
├─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┤
│                         │
│  [無料ではじめる]         │  ← CTA繰り返し
│                         │
└─────────────────────────┘
```

---

## 6. ログイン `/login`

```
┌─────────────────────────┐
│                         │
│         旅程             │  ← ロゴ（中央）
│                         │
│  ┌───────────────────┐  │
│  │ G  Googleでログイン │  │  ← ソーシャルログインボタン
│  └───────────────────┘  │
│  ┌───────────────────┐  │
│  │ L  LINEでログイン   │  │
│  └───────────────────┘  │
│                         │
│  ログインすると利用規約に  │  ← faint, 小さく
│  同意したものとみなします  │
│                         │
└─────────────────────────┘
```

### 認証フロー

1. ボタン押下 → OAuth プロバイダにリダイレクト
2. 認証成功 → `/api/auth/callback/:provider` でトークン発行
3. JWT をクッキー or localStorage に保存
4. `/trips` にリダイレクト

---

## 7. 共有ページ `/s/:token`

旅程ページ (`/trips/:id`) と同じレイアウトを使用。以下の差分のみ：

| 要素 | 通常ページ | 共有ページ |
|------|-----------|-----------|
| ヘッダー | ロゴ + 編集ボタン | ロゴのみ（編集・共有ボタン非表示） |
| フッター | 最小限 | 「旅程で作成」リンク（サービスへの導線） |
| 認証 | 必須 | 不要（トークンで認可） |

### エラー状態

| 状態 | 表示 |
|------|------|
| トークン無効 | 「このリンクは無効です」 |
| トークン期限切れ | 「このリンクは期限切れです」 |
| 旅程削除済み | 「この旅程は見つかりませんでした」 |

---

## 画面遷移図

```
[LP(/)] → [ログイン(/login)] → [一覧(/trips)]
                                    │
                            ┌───────┴────────┐
                            │                │
                      [新規作成]        [旅程ページ]
                     (/trips/new)     (/trips/:id)
                            │                │
                            └──→ [編集ページ] ←┘
                              (/trips/:id/edit)
                                     │
                              [プレビュー]
                             (/trips/:id)

[共有リンク(/s/:token)] → [旅程ページ（閲覧専用）]
```
