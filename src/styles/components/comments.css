/* ========================================
   Comment Section
   ======================================== */

.comment-section {
  @apply mt-[var(--space-7)] pt-[var(--space-6)]
         border-t border-border-light;
}

.comment-section-header {
  @apply flex items-center gap-[var(--space-3)] mb-[var(--space-5)];
}

.comment-section-title {
  @apply text-base font-medium text-text m-0;
}

.comment-section-count {
  @apply text-[0.8125rem] text-text-muted
         bg-bg rounded-s;
  padding: 2px 8px;
}

.comment-loading {
  @apply text-center p-[var(--space-5)] text-text-muted text-sm;
}

.comment-empty {
  @apply text-center p-[var(--space-5)] text-text-faint text-sm;
}

.comment-login-prompt {
  @apply text-center p-[var(--space-5)]
         text-text-muted text-sm
         bg-bg rounded-m mb-[var(--space-4)];

  & a {
    @apply text-accent underline;
  }
}

/* Comment Form */
.comment-form {
  @apply flex flex-col gap-[var(--space-3)]
         p-[var(--space-4)]
         bg-bg-elevated border border-border-light rounded-m
         mb-[var(--space-5)];
}

.comment-form-header {
  @apply flex items-center gap-[var(--space-2)];
}

.comment-form-user {
  @apply text-[0.8125rem] font-medium text-text;
}

.comment-form-actions {
  @apply flex justify-end;
}

.comment-textarea {
  @apply text-sm;
  min-height: 80px;
  resize: vertical;
}

/* Comment List */
.comment-list {
  @apply flex flex-col gap-[var(--space-4)];
}

/* Comment Item */
.comment-item {
  @apply p-[var(--space-4)]
         bg-bg-elevated border border-border-light rounded-m;

  &.comment-pinned {
    @apply border-accent bg-bg;
  }
}

.comment-header {
  @apply flex items-center gap-[var(--space-2)] mb-[var(--space-2)];
}

.comment-avatar {
  @apply size-8 rounded-full object-cover shrink-0;
}

.comment-avatar-small {
  @apply size-6 rounded-full object-cover shrink-0;
}

.comment-avatar-placeholder {
  @apply flex items-center justify-center
         bg-border text-text-muted
         text-xs font-medium;
}

.comment-meta {
  @apply flex items-center gap-[var(--space-2)]
         flex-1 min-w-0 flex-wrap;
}

.comment-author {
  @apply text-sm font-medium text-text;
}

.comment-date {
  @apply text-xs text-text-muted;
}

.comment-pin-badge {
  @apply text-[0.6875rem] text-accent
         bg-bg-elevated rounded-s
         border border-accent;
  padding: 2px 6px;
}

.comment-edited {
  @apply text-xs text-text-faint;
}

.comment-actions {
  @apply flex items-center gap-[var(--space-2)] ml-auto;
}

.comment-action-btn {
  @apply text-xs text-text-muted
         bg-none border-none cursor-pointer;
  padding: 2px 4px;
  transition: color var(--transition-fast);

  &:hover {
    @apply text-text;
  }
}

.comment-action-delete {
  &:hover {
    @apply text-danger;
  }
}

.comment-content {
  @apply text-sm leading-relaxed text-text
         whitespace-pre-wrap break-words;
  margin-left: calc(32px + var(--space-2));
}

/* Reply button */
.comment-reply-btn {
  @apply text-xs text-text-muted
         bg-none border-none p-0
         cursor-pointer mt-[var(--space-2)];
  margin-left: calc(32px + var(--space-2));

  &:hover {
    @apply text-accent underline;
  }
}

/* Edit form */
.comment-edit-form {
  @apply flex flex-col gap-[var(--space-2)];
  margin-left: calc(32px + var(--space-2));
}

.comment-edit-actions {
  @apply flex justify-end gap-[var(--space-2)];
}

/* Reply form */
.comment-reply-form {
  @apply flex flex-col gap-[var(--space-2)]
         mt-[var(--space-3)] p-[var(--space-3)]
         bg-bg rounded-s;
  margin-left: calc(32px + var(--space-2));
}

.comment-reply-actions {
  @apply flex justify-end;
}

/* Replies */
.comment-replies {
  @apply mt-[var(--space-3)]
         pl-[var(--space-3)]
         border-l-2 border-border-light;
  margin-left: calc(32px + var(--space-2));
}

.comment-reply-item {
  @apply py-[var(--space-3)];

  &:not(:last-child) {
    @apply border-b border-border-light;
  }

  & .comment-content {
    margin-left: calc(24px + var(--space-2));
  }

  & .comment-avatar-small {
    @apply size-6;
  }
}

/* Mobile responsive */
@media (max-width: 480px) {
  .comment-section-header {
    @apply flex-col items-start gap-[var(--space-2)];
  }

  .comment-form {
    @apply p-[var(--space-3)];
  }

  .comment-item {
    @apply p-[var(--space-3)] relative;
  }

  .comment-content {
    @apply ml-0 mt-[var(--space-2)];
  }

  .comment-reply-btn {
    @apply ml-0;
  }

  .comment-edit-form {
    @apply ml-0;
  }

  .comment-reply-form {
    @apply ml-0;
  }

  .comment-replies {
    @apply ml-0 pl-[var(--space-3)];
  }

  .comment-reply-item .comment-content {
    @apply ml-0;
  }

  .comment-meta {
    @apply flex-col items-start;
    gap: 2px;
  }

  .comment-actions {
    @apply absolute;
    top: var(--space-3);
    right: var(--space-3);
  }
}
